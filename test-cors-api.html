<!DOCTYPE html>
<html>
<head>
    <title>Test CORS API ImÃ¡genes</title>
</head>
<body>
    <h2>ğŸ§ª Test del API de ImÃ¡genes con CORS</h2>
    <button onclick="testAPI()">Test API Call</button>
    <div id="results"></div>

    <script>
        async function testAPI() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>ğŸ”„ Ejecutando test...</p>';

            try {
                console.log('ğŸš€ Iniciando test de API...');
                
                const response = await fetch('http://localhost/SISEE/api/imagenes.php?entidad_tipo=peticion&entidad_id=64', {
                    method: 'GET',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                console.log('ğŸ“Š Response status:', response.status);
                console.log('ğŸ“Š Response headers:', response.headers);

                if (response.ok) {
                    const data = await response.json();
                    console.log('âœ… Response data:', data);
                    
                    resultsDiv.innerHTML = `
                        <div style="color: green;">
                            <h3>âœ… API Test Successful</h3>
                            <p><strong>Status:</strong> ${response.status}</p>
                            <p><strong>Success:</strong> ${data.success}</p>
                            <p><strong>Total imÃ¡genes:</strong> ${data.total || 0}</p>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('âŒ Error en test:', error);
                resultsDiv.innerHTML = `
                    <div style="color: red;">
                        <h3>âŒ Error en Test</h3>
                        <p>${error.message}</p>
                        <p><strong>Tipo:</strong> ${error.name}</p>
                    </div>
                `;
            }
        }

        // Auto-ejecutar el test al cargar
        window.onload = () => {
            testAPI();
        };
    </script>
</body>
</html>